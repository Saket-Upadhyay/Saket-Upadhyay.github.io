<div class="message">
Reverse Engineering Challenge of Hacker Earth CipherCombat2.0
</div>

<p><img src="https://miro.medium.com/max/916/1*Nuc4N5RaZtr63_YQFhz_0g.png" alt="" /></p>

<h3 id="what-we-get">What we get?</h3>

<p>A zip file with password “hackerearth”… unzip it and we get a Linux Executable
<img src="https://miro.medium.com/max/1400/1*vAjPVcnwMkk3vsJWwFYvCw.png" alt="" /></p>

<p>Notice I highlighted LSB(Least Significant Bit) ? We will see why later…</p>

<h3 id="solving-the-challenge">Solving the challenge</h3>

<p>Let’s do strings …</p>

<p><img src="https://miro.medium.com/max/1400/1*QituOMU8zpAkklSEngDR6g.png" alt="" /></p>

<p>With strings we found some Texts but nothing like our flag.</p>

<p>Important thing to see here is <strong>MD5 function calls</strong> and use of <strong>libcrypto.so.1.1</strong> points at use of MD5 hash algorithm.</p>

<p>Further we can check this by listing all imports by RABIN2</p>

<p><img src="https://miro.medium.com/max/1400/1*Zs5ILlbbLfM-sZEeRbzljw.png" alt="" /></p>

<p>And we see that MD5 global functions are important.</p>

<p>Let’s check the disassembly now…</p>

<p><img src="https://miro.medium.com/max/1400/1*mPe6hOAoX4GAUC4DhYytVA.png" alt="" /></p>

<p>We can see that it compares the MD5 digest of string supplied with a hard coded MD5 value. We can also see it has moved hard-coded hex string to stack at <strong>0x000011ad</strong></p>

<p>Any ways, it is comparing with something in stack, and my favorite way is to fire up GDB and check the stack in real-time to get the data.</p>

<p>Let’s have a look at GDB disassembly…</p>

<p><img src="https://miro.medium.com/max/1368/1*lNZuiBDzkNvgSrHube7sgA.png" alt="" /></p>

<p>We can see that string compare function is at *main+186 so we will put break point there.</p>

<p><img src="https://miro.medium.com/max/1400/1*nmAFCPnQbBwgoA-1C2Jhuw.png" alt="" /></p>

<p><img src="https://miro.medium.com/max/766/1*6qb-pH2gzMPvaOLQhj3dtA.png" alt="" /></p>

<p>Now let’s run the program and provide random input.</p>

<p><img src="https://miro.medium.com/max/1400/1*6ad6Uix5zcBN7SQhMBWVhw.png" alt="" /></p>

<p>We hit our breakpoints ! Let’s check registers, STRNCMP compares values stored in <strong>[R/ESI]</strong> with <strong>[R/EDI]</strong>…</p>

<p><img src="https://miro.medium.com/max/1400/1*GEzuZe_tObGW6OpVnaz-Dg.png" alt="" /></p>

<p>So get address of our hard-coded hash loaded in stack, lets check it out how it’s doing.</p>

<p><img src="https://miro.medium.com/max/1400/1*4ESNSFiNrykRXxfoo0mZ7w.png" alt="" /></p>

<p>And we get our values now let’s reconstruct the MD5</p>

<p>Remember about LSB? these values are stored like that, we need to convert it into MSB and then we can continue.</p>

<p>Copy the values in any text editor and rearrange them as following…</p>

<p><img src="https://miro.medium.com/max/1400/1*6W3H0okjKG1LlN5e5bNaFg.png" alt="" /></p>

<p>so at last we have our hash : <strong>53a167c8d4dc964f7d7838dd4ce2d137</strong></p>

<p>Only thing left to do is brute force it, we can use online services, the one I used and which they later provided in their free hint is https://hashes.org/</p>

<p><img src="https://miro.medium.com/max/1400/1*l3Cq8Jw-b3GGG3qS3V3REw.png" alt="" /></p>

<p>And we have our flag :<strong><em>HE{iamalmighty9}</em></strong></p>

<p><img src="https://miro.medium.com/max/988/1*K7A9d8L1oQ5QBzLxV6Ngkw.png" alt="" /></p>

<p>&lt; And here is a cross check with the challenge binary.</p>

<p>Another Fun challenge! Done.</p>

<blockquote>
  <p>NOTE: we could have done it in 3–4 less steps by just converting the strings found in <strong>MOVABS</strong> instructions,</p>
</blockquote>

<p><img src="https://miro.medium.com/max/1400/1*8RgD9zk0eJD2S6szrk-1Dg.png" alt="" /></p>

<p>But what’s the fun in that, also i wanted to show you the dynamic analysis path. :-)</p>

<hr />
