<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="https://gmpg.org/xfn/11" rel="profile" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />

  <title>
    
      DDoS attack Simulation in NS3 &middot; Saket Upadhyay
    
  </title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-163708069-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }
  gtag('js', new Date());

  gtag('config', 'UA-163708069-1');
</script>


  <!-- CSS -->
  <link rel="stylesheet" href="/assets/css/main.css" />
  

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface" />

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/favicon.png" />
<link rel="shortcut icon" href="/favicon.ico" />

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" />

  <!-- Additional head bits without overriding original head -->
</head>


  <body class="post">

    <div id="sidebar">
  <header>
    <div class="site-title">
      <a>
        
          <span class="back-arrow icon"><svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
  <path d="M0 0h24v24H0z" fill="none"/>
  <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
</svg></span>
        
        Saket Upadhyay
      </a>
    </div>
    <p class="lead">Cybersecurity Student. Security Researcher Wannabe. </p>
  </header>
  <nav id="sidebar-nav-links">
  
    <a class="home-link "
        href="/">Home</a>
  
  

  

  


  
    
  

  
    
      <a class="page-link "
          href="/about.html">About Me</a>
    
  

  
    
  

  

  
    
      <a class="page-link "
          href="/malware.html">Malware Analysis Reports</a>
    
  

  
    
      <a class="page-link "
          href="/projects.html">Projects</a>
    
  

  
    
  

  
    
      <a class="page-link "
          href="/publications.html">Publications</a>
    
  

  
    
  

  
    
      <a class="page-link "
          href="/topics.html">Topics</a>
    
  

  

  
    
  

  

  

  
    
  

  
    
  

  
    
  

  

  


  


  
    
  

  
    
  

  
    
  

  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  

  
    
  

  

  

  
    
  

  
    
  

  
    
  

  

  


  <!-- Optional additional links to insert in sidebar nav -->
</nav>


  <!--  -->

  <nav id="sidebar-icon-links">
  <!--  -->



    <a id="github-link" class="icon" title="Github" aria-label="Github"
      href="https://github.com/Saket-Upadhyay">
      <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 28" height="24" width="28"><path d="M12 2c6.625 0 12 5.375 12 12 0 5.297-3.437 9.797-8.203 11.391-0.609 0.109-0.828-0.266-0.828-0.578 0-0.391 0.016-1.687 0.016-3.297 0-1.125-0.375-1.844-0.812-2.219 2.672-0.297 5.484-1.313 5.484-5.922 0-1.313-0.469-2.375-1.234-3.219 0.125-0.313 0.531-1.531-0.125-3.187-1-0.313-3.297 1.234-3.297 1.234-0.953-0.266-1.984-0.406-3-0.406s-2.047 0.141-3 0.406c0 0-2.297-1.547-3.297-1.234-0.656 1.656-0.25 2.875-0.125 3.187-0.766 0.844-1.234 1.906-1.234 3.219 0 4.594 2.797 5.625 5.469 5.922-0.344 0.313-0.656 0.844-0.766 1.609-0.688 0.313-2.438 0.844-3.484-1-0.656-1.141-1.844-1.234-1.844-1.234-1.172-0.016-0.078 0.734-0.078 0.734 0.781 0.359 1.328 1.75 1.328 1.75 0.703 2.141 4.047 1.422 4.047 1.422 0 1 0.016 1.937 0.016 2.234 0 0.313-0.219 0.688-0.828 0.578-4.766-1.594-8.203-6.094-8.203-11.391 0-6.625 5.375-12 12-12zM4.547 19.234c0.031-0.063-0.016-0.141-0.109-0.187-0.094-0.031-0.172-0.016-0.203 0.031-0.031 0.063 0.016 0.141 0.109 0.187 0.078 0.047 0.172 0.031 0.203-0.031zM5.031 19.766c0.063-0.047 0.047-0.156-0.031-0.25-0.078-0.078-0.187-0.109-0.25-0.047-0.063 0.047-0.047 0.156 0.031 0.25 0.078 0.078 0.187 0.109 0.25 0.047zM5.5 20.469c0.078-0.063 0.078-0.187 0-0.297-0.063-0.109-0.187-0.156-0.266-0.094-0.078 0.047-0.078 0.172 0 0.281s0.203 0.156 0.266 0.109zM6.156 21.125c0.063-0.063 0.031-0.203-0.063-0.297-0.109-0.109-0.25-0.125-0.313-0.047-0.078 0.063-0.047 0.203 0.063 0.297 0.109 0.109 0.25 0.125 0.313 0.047zM7.047 21.516c0.031-0.094-0.063-0.203-0.203-0.25-0.125-0.031-0.266 0.016-0.297 0.109s0.063 0.203 0.203 0.234c0.125 0.047 0.266 0 0.297-0.094zM8.031 21.594c0-0.109-0.125-0.187-0.266-0.172-0.141 0-0.25 0.078-0.25 0.172 0 0.109 0.109 0.187 0.266 0.172 0.141 0 0.25-0.078 0.25-0.172zM8.937 21.438c-0.016-0.094-0.141-0.156-0.281-0.141-0.141 0.031-0.234 0.125-0.219 0.234 0.016 0.094 0.141 0.156 0.281 0.125s0.234-0.125 0.219-0.219z"></path>
</svg>

    </a>
  <a id="linkedin-link" class="icon" title="Linked-In" aria-label="Linked-In" href="https://www.linkedin.com/in/saketupadhyay/">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg>
  </a>

  <a id="twitter-link" class="icon" title="Twitter" aria-label="Twitter" href="https://twitter.com/x64mayhem">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-.139 9.237c.209 4.617-3.234 9.765-9.33 9.765-1.854 0-3.579-.543-5.032-1.475 1.742.205 3.48-.278 4.86-1.359-1.437-.027-2.649-.976-3.066-2.28.515.098 1.021.069 1.482-.056-1.579-.317-2.668-1.739-2.633-3.26.442.246.949.394 1.486.411-1.461-.977-1.875-2.907-1.016-4.383 1.619 1.986 4.038 3.293 6.766 3.43-.479-2.053 1.08-4.03 3.199-4.03.943 0 1.797.398 2.395 1.037.748-.147 1.451-.42 2.086-.796-.246.767-.766 1.41-1.443 1.816.664-.08 1.297-.256 1.885-.517-.439.656-.996 1.234-1.639 1.697z"/></svg>
  </a>


  <!-- <a id="subscribe-link"
     class="icon" title="Subscribe" aria-label="Subscribe"
     href="/feed.xml">
    <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <circle cx="6.18" cy="17.82" r="2.18"/>
    <path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/>
</svg>
  </a> -->

  
  
  
  

<a id="research-link"
       class="icon"
       title="Tags" aria-label="Tags"
       href="https://orcid.org/0000-0003-0574-7843">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M20.759 20.498c-2.342-3.663-5.575-6.958-5.743-11.498h-2.016c.173 5.212 3.512 8.539 5.953 12.356.143.302-.068.644-.377.644h-1.264l-4.734-7h-3.52c.873-1.665 1.85-3.414 1.936-6h-2.01c-.169 4.543-3.421 7.864-5.743 11.498-.165.347-.241.707-.241 1.057 0 1.283 1.023 2.445 2.423 2.445h13.153c1.4 0 2.424-1.162 2.424-2.446 0-.35-.076-.709-.241-1.056zm-4.759-15.498c0 1.105-.896 2-2 2s-2-.895-2-2 .896-2 2-2 2 .895 2 2zm-5-1.5c0 .829-.672 1.5-1.5 1.5s-1.5-.671-1.5-1.5.672-1.5 1.5-1.5 1.5.671 1.5 1.5zm0 3.5c0 .552-.447 1-1 1s-1-.448-1-1 .447-1 1-1 1 .448 1 1zm3-6c0 .552-.447 1-1 1s-1-.448-1-1 .447-1 1-1 1 .448 1 1z"/></svg>
</a>

  <a id="email-link" class="icon" title="Tags" aria-label="Tags" href="mailto:x64mayhem@gmail.com">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12 12.713l-11.985-9.713h23.971l-11.986 9.713zm-5.425-1.822l-6.575-5.329v12.501l6.575-7.172zm10.85 0l6.575 7.172v-12.501l-6.575 5.329zm-1.557 1.261l-3.868 3.135-3.868-3.135-8.11 8.848h23.956l-8.11-8.848z"/></svg>
  </a>

<!-- <a id="search-link"
       class="icon"
       title="Search" aria-label="Search"
       href="/search.html">
      <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
    <path d="M0 0h24v24H0z" fill="none"/>
</svg>
</a> -->
<a id="key-link" class="icon"  aria-label="PGP"
  href="/pubkey.html">
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12.451 17.337l-2.451 2.663h-2v2h-2v2h-6v-5l6.865-6.949c1.08 2.424 3.095 4.336 5.586 5.286zm11.549-9.337c0 4.418-3.582 8-8 8s-8-3.582-8-8 3.582-8 8-8 8 3.582 8 8zm-3-3c0-1.104-.896-2-2-2s-2 .896-2 2 .896 2 2 2 2-.896 2-2z"/></svg>
</a>

  <!-- Optional additional links to insert for icons links -->
</nav>

  <p>
  <!-- &copy; 2020.
  <a href="/LICENSE.md">MIT License.</a> -->
</p>

</div>

    <main class="container">
      <header>
  <h1 class="post-title">DDoS attack Simulation in NS3</h1>
</header>
<div class="content">
  <div class="post-meta">
  <span class="post-date">10 Aug 2020</span>
  <span class="post-categories">
    
  </span>
</div>


  <div class="post-body">
    <div class="message">
Distributed Denial of Service Attack Simuation Build from scratch in C++
</div>

<p><img src="https://miro.medium.com/max/700/1*Gaixy9imX-y-q7NJQY5qog.png" alt="" /></p>

<h3 id="what-is-this">What is this?</h3>
<p>This article is about coding a Distributed Denial of Service Attack simulation in NS-3 discrete event network simulator.</p>

<h3 id="why-do-we-need-it">Why do we need it?</h3>

<p>Because visual representation of basic concepts which you can play around with is better right?</p>

<h3 id="where-can-you-get-the-code">Where can you get the code?</h3>

<p>As part of a community project I am collecting / building multiple cybersecurity simulations and scenarios in NS3 and logging them in GitHub.</p>

<p>You can check the repo from<code class="language-plaintext highlighter-rouge">PROJECTS</code> section of this site.</p>

<h3 id="how-to-">How to ?</h3>
<p>Now this is what this article is all about. Let’s jump into it.</p>

<h4 id="creating-base-model">Creating Base Model</h4>
<p>The base model for this attack is relatively simple : We have 3 main nodes Alice [n0] (Legitimate Client), Bob [ n2] (Server Application) and a connecting node in between let’s say Dave [n1].</p>

<p><img src="https://miro.medium.com/max/512/1*V3PJ6E4Mba2zMnW71GwbgQ.png" alt="" />(“Legitimate Connection Model”)</p>

<p>Now we will add as many bots we want to attack the network and let’s call them Mallory <code class="language-plaintext highlighter-rouge">[bi | i∈ (N)]</code>.</p>

<h4 id="code-c">Code [C++]</h4>

<p>Let’s first include all the required headers.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;ns3/csma-helper.h&gt;
#include "ns3/mobility-module.h"
#include "ns3/nstime.h"
#include "ns3/core-module.h"
#include "ns3/network-module.h"
#include "ns3/internet-module.h"
#include "ns3/point-to-point-module.h"
#include "ns3/applications-module.h"
#include "ns3/ipv4-global-routing-helper.h"
#include "ns3/netanim-module.h"
</span></code></pre></div></div>
<p>next we define some global configurations so that we can play around with them later.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#define TCP_SINK_PORT 9000
#define UDP_SINK_PORT 9001
</span>
<span class="c1">//experimental parameters</span>
<span class="cp">#define MAX_BULK_BYTES 100000
#define DDOS_RATE "20480kb/s"
#define MAX_SIMULATION_TIME 10.0
</span>
<span class="c1">//Number of Bots for DDoS</span>
<span class="cp">#define NUMBER_OF_BOTS 10
</span>
<span class="n">NS_LOG_COMPONENT_DEFINE</span><span class="p">(</span><span class="s">"DDoSAttack"</span><span class="p">);</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">ns3</span><span class="p">;</span>
</code></pre></div></div>
<p>Now inside typical <code class="language-plaintext highlighter-rouge">main()</code> function we will start creating our base model.</p>

<h4 id="creating-nodes">Creating Nodes</h4>

<p>Nodes are nothing but the points of communication we structured in our design phase.</p>

<p>This will create 3 good nodes and as many Bot nodes defined by <code class="language-plaintext highlighter-rouge">NUMBER_OF_BOTS</code>.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//Legitimate connection bots</span>
<span class="n">NodeContainer</span> <span class="n">nodes</span><span class="p">;</span>
<span class="n">nodes</span><span class="p">.</span><span class="n">Create</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>

<span class="c1">//Nodes for attack bots</span>
<span class="n">NodeContainer</span> <span class="n">botNodes</span><span class="p">;</span>
<span class="n">botNodes</span><span class="p">.</span><span class="n">Create</span><span class="p">(</span><span class="n">NUMBER_OF_BOTS</span><span class="p">);</span>
</code></pre></div></div>

<h4 id="connecting-nodes">Connecting Nodes</h4>

<p>We can use point-to-point helper to connect different nodes.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Define the Point-To-Point Links and their Paramters</span>
<span class="n">PointToPointHelper</span> <span class="n">pp1</span><span class="p">,</span> <span class="n">pp2</span><span class="p">;</span>
<span class="n">pp1</span><span class="p">.</span><span class="n">SetDeviceAttribute</span><span class="p">(</span><span class="s">"DataRate"</span><span class="p">,</span> <span class="n">StringValue</span><span class="p">(</span><span class="s">"100Mbps"</span><span class="p">));</span>
<span class="n">pp1</span><span class="p">.</span><span class="n">SetChannelAttribute</span><span class="p">(</span><span class="s">"Delay"</span><span class="p">,</span> <span class="n">StringValue</span><span class="p">(</span><span class="s">"1ms"</span><span class="p">));</span>

<span class="n">pp2</span><span class="p">.</span><span class="n">SetDeviceAttribute</span><span class="p">(</span><span class="s">"DataRate"</span><span class="p">,</span> <span class="n">StringValue</span><span class="p">(</span><span class="s">"100Mbps"</span><span class="p">));</span>
<span class="n">pp2</span><span class="p">.</span><span class="n">SetChannelAttribute</span><span class="p">(</span><span class="s">"Delay"</span><span class="p">,</span> <span class="n">StringValue</span><span class="p">(</span><span class="s">"1ms"</span><span class="p">));</span>

</code></pre></div></div>
<p>and then install the P2P device in the nodes to actually connect them. One thing to keep in mind here is that our number of bots are dynamic and we don’t want the user to change the whole algorithm when changing the number so we can use simple for loop for P2P installation in the bots.</p>

<p><strong><em>We will use these “for-loops” wherever we will assign or install something to bot nodes.</em></strong></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">NetDeviceContainer</span> <span class="n">d02</span><span class="p">,</span> <span class="n">d12</span><span class="p">,</span> <span class="n">botDeviceContainer</span><span class="p">[</span><span class="n">NUMBER_OF_BOTS</span><span class="p">];</span>
<span class="n">d02</span> <span class="o">=</span> <span class="n">pp1</span><span class="p">.</span><span class="n">Install</span><span class="p">(</span><span class="n">nodes</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">nodes</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
<span class="n">d12</span> <span class="o">=</span> <span class="n">pp1</span><span class="p">.</span><span class="n">Install</span><span class="p">(</span><span class="n">nodes</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">nodes</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>

<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">NUMBER_OF_BOTS</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">botDeviceContainer</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pp2</span><span class="p">.</span><span class="n">Install</span><span class="p">(</span><span class="n">botNodes</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">nodes</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="assignment-of-ip-address-and-internet-stack">Assignment of IP Address and Internet Stack</h4>

<p>In this case we are using IPv4 Address for our nodes and can be setup by ipv4-helper class. This will connect our devices to virtual internet stack.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//Assign IP to bots</span>
<span class="n">InternetStackHelper</span> <span class="n">stack</span><span class="p">;</span>
<span class="n">stack</span><span class="p">.</span><span class="n">Install</span><span class="p">(</span><span class="n">nodes</span><span class="p">);</span>
<span class="n">stack</span><span class="p">.</span><span class="n">Install</span><span class="p">(</span><span class="n">botNodes</span><span class="p">);</span>
<span class="n">Ipv4AddressHelper</span> <span class="n">ipv4_n</span><span class="p">;</span>
<span class="n">ipv4_n</span><span class="p">.</span><span class="n">SetBase</span><span class="p">(</span><span class="s">"10.0.0.0"</span><span class="p">,</span> <span class="s">"255.255.255.252"</span><span class="p">);</span>

<span class="n">Ipv4AddressHelper</span> <span class="n">a02</span><span class="p">,</span> <span class="n">a12</span><span class="p">,</span> <span class="n">a23</span><span class="p">,</span> <span class="n">a34</span><span class="p">;</span>
<span class="n">a02</span><span class="p">.</span><span class="n">SetBase</span><span class="p">(</span><span class="s">"10.1.1.0"</span><span class="p">,</span> <span class="s">"255.255.255.0"</span><span class="p">);</span>
<span class="n">a12</span><span class="p">.</span><span class="n">SetBase</span><span class="p">(</span><span class="s">"10.1.2.0"</span><span class="p">,</span> <span class="s">"255.255.255.0"</span><span class="p">);</span>

<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">NUMBER_OF_BOTS</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">ipv4_n</span><span class="p">.</span><span class="n">Assign</span><span class="p">(</span><span class="n">botDeviceContainer</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
    <span class="n">ipv4_n</span><span class="p">.</span><span class="n">NewNetwork</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1">//Assign IP to legitimate nodes</span>
<span class="n">Ipv4InterfaceContainer</span> <span class="n">i02</span><span class="p">,</span> <span class="n">i12</span><span class="p">;</span>
<span class="n">i02</span> <span class="o">=</span> <span class="n">a02</span><span class="p">.</span><span class="n">Assign</span><span class="p">(</span><span class="n">d02</span><span class="p">);</span>
<span class="n">i12</span> <span class="o">=</span> <span class="n">a12</span><span class="p">.</span><span class="n">Assign</span><span class="p">(</span><span class="n">d12</span><span class="p">);</span>
</code></pre></div></div>

<h4 id="installing-attacker-application-in-the-bots">Installing Attacker Application in the bots</h4>

<p>Now we want to install applications in our nodes so that they can communicate with their neighbors. Let’s create attacker application.</p>

<p>The attacker application in this case is simple UDP OnOff Sender which can be created by :</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// DDoS Application Behaviour</span>
<span class="n">OnOffHelper</span> <span class="nf">onoff</span><span class="p">(</span><span class="s">"ns3::UdpSocketFactory"</span><span class="p">,</span> <span class="n">Address</span><span class="p">(</span><span class="n">InetSocketAddress</span><span class="p">(</span><span class="n">i12</span><span class="p">.</span><span class="n">GetAddress</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">UDP_SINK_PORT</span><span class="p">)));</span>
<span class="n">onoff</span><span class="p">.</span><span class="n">SetConstantRate</span><span class="p">(</span><span class="n">DataRate</span><span class="p">(</span><span class="n">DDOS_RATE</span><span class="p">));</span>
<span class="n">onoff</span><span class="p">.</span><span class="n">SetAttribute</span><span class="p">(</span><span class="s">"OnTime"</span><span class="p">,</span> <span class="n">StringValue</span><span class="p">(</span><span class="s">"ns3::ConstantRandomVariable[Constant=30]"</span><span class="p">));</span>
<span class="n">onoff</span><span class="p">.</span><span class="n">SetAttribute</span><span class="p">(</span><span class="s">"OffTime"</span><span class="p">,</span> <span class="n">StringValue</span><span class="p">(</span><span class="s">"ns3::ConstantRandomVariable[Constant=0]"</span><span class="p">));</span>
<span class="n">ApplicationContainer</span> <span class="n">onOffApp</span><span class="p">[</span><span class="n">NUMBER_OF_BOTS</span><span class="p">];</span>
</code></pre></div></div>
<p>Then we can install in each bot node by :</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//Install application in all bots</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">NUMBER_OF_BOTS</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">onOffApp</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">onoff</span><span class="p">.</span><span class="n">Install</span><span class="p">(</span><span class="n">botNodes</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="n">k</span><span class="p">));</span>
    <span class="n">onOffApp</span><span class="p">[</span><span class="n">k</span><span class="p">].</span><span class="n">Start</span><span class="p">(</span><span class="n">Seconds</span><span class="p">(</span><span class="mf">0.0</span><span class="p">));</span>
    <span class="n">onOffApp</span><span class="p">[</span><span class="n">k</span><span class="p">].</span><span class="n">Stop</span><span class="p">(</span><span class="n">Seconds</span><span class="p">(</span><span class="n">MAX_SIMULATION_TIME</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="client-application">Client Application</h4>

<p>Now the client also needs application stack to simulate communication from server. We will use BulkTCP connection for this purpose simulation some large file transfer for resource request.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Sender Application (Packets generated by this application are throttled)</span>
<span class="n">BulkSendHelper</span> <span class="nf">bulkSend</span><span class="p">(</span><span class="s">"ns3::TcpSocketFactory"</span><span class="p">,</span> <span class="n">InetSocketAddress</span><span class="p">(</span><span class="n">i12</span><span class="p">.</span><span class="n">GetAddress</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">TCP_SINK_PORT</span><span class="p">));</span>
<span class="n">bulkSend</span><span class="p">.</span><span class="n">SetAttribute</span><span class="p">(</span><span class="s">"MaxBytes"</span><span class="p">,</span> <span class="n">UintegerValue</span><span class="p">(</span><span class="n">MAX_BULK_BYTES</span><span class="p">));</span>
<span class="n">ApplicationContainer</span> <span class="n">bulkSendApp</span> <span class="o">=</span> <span class="n">bulkSend</span><span class="p">.</span><span class="n">Install</span><span class="p">(</span><span class="n">nodes</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
<span class="n">bulkSendApp</span><span class="p">.</span><span class="n">Start</span><span class="p">(</span><span class="n">Seconds</span><span class="p">(</span><span class="mf">0.0</span><span class="p">));</span>
<span class="n">bulkSendApp</span><span class="p">.</span><span class="n">Stop</span><span class="p">(</span><span class="n">Seconds</span><span class="p">(</span><span class="n">MAX_SIMULATION_TIME</span> <span class="o">-</span> <span class="mi">10</span><span class="p">));</span>

</code></pre></div></div>

<h4 id="server-side-tcp-and-udp-sinks">Server Side TCP and UDP sinks</h4>

<p>Now let’s install application in our server to receive these packets</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// UDPSink on receiver side</span>
<span class="n">PacketSinkHelper</span> <span class="nf">UDPsink</span><span class="p">(</span><span class="s">"ns3::UdpSocketFactory"</span><span class="p">,</span>
                         <span class="n">Address</span><span class="p">(</span><span class="n">InetSocketAddress</span><span class="p">(</span><span class="n">Ipv4Address</span><span class="o">::</span><span class="n">GetAny</span><span class="p">(),</span> <span class="n">UDP_SINK_PORT</span><span class="p">)));</span>
<span class="n">ApplicationContainer</span> <span class="n">UDPSinkApp</span> <span class="o">=</span> <span class="n">UDPsink</span><span class="p">.</span><span class="n">Install</span><span class="p">(</span><span class="n">nodes</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>
<span class="n">UDPSinkApp</span><span class="p">.</span><span class="n">Start</span><span class="p">(</span><span class="n">Seconds</span><span class="p">(</span><span class="mf">0.0</span><span class="p">));</span>
<span class="n">UDPSinkApp</span><span class="p">.</span><span class="n">Stop</span><span class="p">(</span><span class="n">Seconds</span><span class="p">(</span><span class="n">MAX_SIMULATION_TIME</span><span class="p">));</span>

<span class="c1">// TCP Sink Application on server side</span>
<span class="n">PacketSinkHelper</span> <span class="nf">TCPsink</span><span class="p">(</span><span class="s">"ns3::TcpSocketFactory"</span><span class="p">,</span>
                         <span class="n">InetSocketAddress</span><span class="p">(</span><span class="n">Ipv4Address</span><span class="o">::</span><span class="n">GetAny</span><span class="p">(),</span> <span class="n">TCP_SINK_PORT</span><span class="p">));</span>
<span class="n">ApplicationContainer</span> <span class="n">TCPSinkApp</span> <span class="o">=</span> <span class="n">TCPsink</span><span class="p">.</span><span class="n">Install</span><span class="p">(</span><span class="n">nodes</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>
<span class="n">TCPSinkApp</span><span class="p">.</span><span class="n">Start</span><span class="p">(</span><span class="n">Seconds</span><span class="p">(</span><span class="mf">0.0</span><span class="p">));</span>
<span class="n">TCPSinkApp</span><span class="p">.</span><span class="n">Stop</span><span class="p">(</span><span class="n">Seconds</span><span class="p">(</span><span class="n">MAX_SIMULATION_TIME</span><span class="p">));</span>

</code></pre></div></div>

<p>We can then populate the IP ROUTING TABLE by :</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Ipv4GlobalRoutingHelper</span><span class="o">::</span><span class="n">PopulateRoutingTables</span><span class="p">();</span>
</code></pre></div></div>
<p>This will bake all the network connections and applications in place for simulation.</p>

<h4 id="setting-up-animation-in-netanim-module">Setting up Animation in NetAnim Module</h4>

<p>Our main structure is complete and now we can prepare our simulation grounds.</p>

<p>Configuring mobility in nodes:</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//Simulation NetAnim configuration and node placement</span>
<span class="n">MobilityHelper</span> <span class="n">mobility</span><span class="p">;</span>

<span class="n">mobility</span><span class="p">.</span><span class="n">SetPositionAllocator</span><span class="p">(</span><span class="s">"ns3::GridPositionAllocator"</span><span class="p">,</span>
                              <span class="s">"MinX"</span><span class="p">,</span> <span class="n">DoubleValue</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s">"MinY"</span><span class="p">,</span> <span class="n">DoubleValue</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s">"DeltaX"</span><span class="p">,</span> <span class="n">DoubleValue</span><span class="p">(</span><span class="mf">5.0</span><span class="p">),</span> <span class="s">"DeltaY"</span><span class="p">,</span> <span class="n">DoubleValue</span><span class="p">(</span><span class="mf">10.0</span><span class="p">),</span>
                              <span class="s">"GridWidth"</span><span class="p">,</span> <span class="n">UintegerValue</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="s">"LayoutType"</span><span class="p">,</span> <span class="n">StringValue</span><span class="p">(</span><span class="s">"RowFirst"</span><span class="p">));</span>

<span class="n">mobility</span><span class="p">.</span><span class="n">SetMobilityModel</span><span class="p">(</span><span class="s">"ns3::ConstantPositionMobilityModel"</span><span class="p">);</span>

<span class="n">mobility</span><span class="p">.</span><span class="n">Install</span><span class="p">(</span><span class="n">nodes</span><span class="p">);</span>
<span class="n">mobility</span><span class="p">.</span><span class="n">Install</span><span class="p">(</span><span class="n">botNodes</span><span class="p">);</span>
</code></pre></div></div>

<p>Placing Nodes in Simulation Grid:</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">AnimationInterface</span> <span class="nf">anim</span><span class="p">(</span><span class="s">"DDoSim.xml"</span><span class="p">);</span>

<span class="n">ns3</span><span class="o">::</span><span class="n">AnimationInterface</span><span class="o">::</span><span class="n">SetConstantPosition</span><span class="p">(</span><span class="n">nodes</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="n">ns3</span><span class="o">::</span><span class="n">AnimationInterface</span><span class="o">::</span><span class="n">SetConstantPosition</span><span class="p">(</span><span class="n">nodes</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
<span class="n">ns3</span><span class="o">::</span><span class="n">AnimationInterface</span><span class="o">::</span><span class="n">SetConstantPosition</span><span class="p">(</span><span class="n">nodes</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>

<span class="kt">uint32_t</span> <span class="n">x_pos</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">l</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">l</span> <span class="o">&lt;</span> <span class="n">NUMBER_OF_BOTS</span><span class="p">;</span> <span class="o">++</span><span class="n">l</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">ns3</span><span class="o">::</span><span class="n">AnimationInterface</span><span class="o">::</span><span class="n">SetConstantPosition</span><span class="p">(</span><span class="n">botNodes</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="n">x_pos</span><span class="o">++</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>
<p>We are almost done then we just need to run the simulation and view in NetAnim.</p>

<h3 id="full-code">Full Code</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/*       
 * LICENSE : GNU General Public License v3.0 (https://github.com/Saket-Upadhyay/ns3-cybersecurity-simulations/blob/master/LICENSE)
 * REPOSITORY : https://github.com/Saket-Upadhyay/ns3-cybersecurity-simulations
 * =================================================================================
 * 
 * In this we follow the following setup / node placement
 * 
 *    (n1)
 *      \
 *       \
 *         -------- (n2) -------- (n3)
 *                 / |  \
 *                /  |   \ 
 *               /   |    \
 *             (B0),(B2)...(Bn) 
 *                 
 *  N0 is legitimate user, communicating with server N2 (data server) via node N1 (maybe website server interface )
 *  B0-Bn are bots DDoS-ing the network.
 * 
 * NetAnim XML is saved as -&gt; DDoSim.xml 
 *  
 */</span>
<span class="cp">#include &lt;ns3/csma-helper.h&gt;
#include "ns3/mobility-module.h"
#include "ns3/nstime.h"
#include "ns3/core-module.h"
#include "ns3/network-module.h"
#include "ns3/internet-module.h"
#include "ns3/point-to-point-module.h"
#include "ns3/applications-module.h"
#include "ns3/ipv4-global-routing-helper.h"
#include "ns3/netanim-module.h"
</span>
<span class="cp">#define TCP_SINK_PORT 9000
#define UDP_SINK_PORT 9001
</span>
<span class="c1">//experimental parameters</span>
<span class="cp">#define MAX_BULK_BYTES 100000
#define DDOS_RATE "20480kb/s"
#define MAX_SIMULATION_TIME 10.0
</span>
<span class="c1">//Number of Bots for DDoS</span>
<span class="cp">#define NUMBER_OF_BOTS 10
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">ns3</span><span class="p">;</span>

<span class="n">NS_LOG_COMPONENT_DEFINE</span><span class="p">(</span><span class="s">"DDoSAttack"</span><span class="p">);</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="n">CommandLine</span> <span class="n">cmd</span><span class="p">;</span>
    <span class="n">cmd</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">);</span>

    <span class="n">Time</span><span class="o">::</span><span class="n">SetResolution</span><span class="p">(</span><span class="n">Time</span><span class="o">::</span><span class="n">NS</span><span class="p">);</span>
    <span class="n">LogComponentEnable</span><span class="p">(</span><span class="s">"UdpEchoClientApplication"</span><span class="p">,</span> <span class="n">LOG_LEVEL_INFO</span><span class="p">);</span>
    <span class="n">LogComponentEnable</span><span class="p">(</span><span class="s">"UdpEchoServerApplication"</span><span class="p">,</span> <span class="n">LOG_LEVEL_INFO</span><span class="p">);</span>


    <span class="c1">//Legitimate connection bots</span>
    <span class="n">NodeContainer</span> <span class="n">nodes</span><span class="p">;</span>
    <span class="n">nodes</span><span class="p">.</span><span class="n">Create</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>

    <span class="c1">//Nodes for attack bots</span>
    <span class="n">NodeContainer</span> <span class="n">botNodes</span><span class="p">;</span>
    <span class="n">botNodes</span><span class="p">.</span><span class="n">Create</span><span class="p">(</span><span class="n">NUMBER_OF_BOTS</span><span class="p">);</span>

    <span class="c1">// Define the Point-To-Point Links and their Paramters</span>
    <span class="n">PointToPointHelper</span> <span class="n">pp1</span><span class="p">,</span> <span class="n">pp2</span><span class="p">;</span>
    <span class="n">pp1</span><span class="p">.</span><span class="n">SetDeviceAttribute</span><span class="p">(</span><span class="s">"DataRate"</span><span class="p">,</span> <span class="n">StringValue</span><span class="p">(</span><span class="s">"100Mbps"</span><span class="p">));</span>
    <span class="n">pp1</span><span class="p">.</span><span class="n">SetChannelAttribute</span><span class="p">(</span><span class="s">"Delay"</span><span class="p">,</span> <span class="n">StringValue</span><span class="p">(</span><span class="s">"1ms"</span><span class="p">));</span>

    <span class="n">pp2</span><span class="p">.</span><span class="n">SetDeviceAttribute</span><span class="p">(</span><span class="s">"DataRate"</span><span class="p">,</span> <span class="n">StringValue</span><span class="p">(</span><span class="s">"100Mbps"</span><span class="p">));</span>
    <span class="n">pp2</span><span class="p">.</span><span class="n">SetChannelAttribute</span><span class="p">(</span><span class="s">"Delay"</span><span class="p">,</span> <span class="n">StringValue</span><span class="p">(</span><span class="s">"1ms"</span><span class="p">));</span>

    <span class="c1">// Install the Point-To-Point Connections between Nodes</span>
    <span class="n">NetDeviceContainer</span> <span class="n">d02</span><span class="p">,</span> <span class="n">d12</span><span class="p">,</span> <span class="n">botDeviceContainer</span><span class="p">[</span><span class="n">NUMBER_OF_BOTS</span><span class="p">];</span>
    <span class="n">d02</span> <span class="o">=</span> <span class="n">pp1</span><span class="p">.</span><span class="n">Install</span><span class="p">(</span><span class="n">nodes</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">nodes</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
    <span class="n">d12</span> <span class="o">=</span> <span class="n">pp1</span><span class="p">.</span><span class="n">Install</span><span class="p">(</span><span class="n">nodes</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">nodes</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">NUMBER_OF_BOTS</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">botDeviceContainer</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pp2</span><span class="p">.</span><span class="n">Install</span><span class="p">(</span><span class="n">botNodes</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">nodes</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="c1">//Assign IP to bots</span>
    <span class="n">InternetStackHelper</span> <span class="n">stack</span><span class="p">;</span>
    <span class="n">stack</span><span class="p">.</span><span class="n">Install</span><span class="p">(</span><span class="n">nodes</span><span class="p">);</span>
    <span class="n">stack</span><span class="p">.</span><span class="n">Install</span><span class="p">(</span><span class="n">botNodes</span><span class="p">);</span>
    <span class="n">Ipv4AddressHelper</span> <span class="n">ipv4_n</span><span class="p">;</span>
    <span class="n">ipv4_n</span><span class="p">.</span><span class="n">SetBase</span><span class="p">(</span><span class="s">"10.0.0.0"</span><span class="p">,</span> <span class="s">"255.255.255.252"</span><span class="p">);</span>

    <span class="n">Ipv4AddressHelper</span> <span class="n">a02</span><span class="p">,</span> <span class="n">a12</span><span class="p">,</span> <span class="n">a23</span><span class="p">,</span> <span class="n">a34</span><span class="p">;</span>
    <span class="n">a02</span><span class="p">.</span><span class="n">SetBase</span><span class="p">(</span><span class="s">"10.1.1.0"</span><span class="p">,</span> <span class="s">"255.255.255.0"</span><span class="p">);</span>
    <span class="n">a12</span><span class="p">.</span><span class="n">SetBase</span><span class="p">(</span><span class="s">"10.1.2.0"</span><span class="p">,</span> <span class="s">"255.255.255.0"</span><span class="p">);</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">NUMBER_OF_BOTS</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">ipv4_n</span><span class="p">.</span><span class="n">Assign</span><span class="p">(</span><span class="n">botDeviceContainer</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
        <span class="n">ipv4_n</span><span class="p">.</span><span class="n">NewNetwork</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="c1">//Assign IP to legitimate nodes</span>
    <span class="n">Ipv4InterfaceContainer</span> <span class="n">i02</span><span class="p">,</span> <span class="n">i12</span><span class="p">;</span>
    <span class="n">i02</span> <span class="o">=</span> <span class="n">a02</span><span class="p">.</span><span class="n">Assign</span><span class="p">(</span><span class="n">d02</span><span class="p">);</span>
    <span class="n">i12</span> <span class="o">=</span> <span class="n">a12</span><span class="p">.</span><span class="n">Assign</span><span class="p">(</span><span class="n">d12</span><span class="p">);</span>

    <span class="c1">// DDoS Application Behaviour</span>
    <span class="n">OnOffHelper</span> <span class="n">onoff</span><span class="p">(</span><span class="s">"ns3::UdpSocketFactory"</span><span class="p">,</span> <span class="n">Address</span><span class="p">(</span><span class="n">InetSocketAddress</span><span class="p">(</span><span class="n">i12</span><span class="p">.</span><span class="n">GetAddress</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">UDP_SINK_PORT</span><span class="p">)));</span>
    <span class="n">onoff</span><span class="p">.</span><span class="n">SetConstantRate</span><span class="p">(</span><span class="n">DataRate</span><span class="p">(</span><span class="n">DDOS_RATE</span><span class="p">));</span>
    <span class="n">onoff</span><span class="p">.</span><span class="n">SetAttribute</span><span class="p">(</span><span class="s">"OnTime"</span><span class="p">,</span> <span class="n">StringValue</span><span class="p">(</span><span class="s">"ns3::ConstantRandomVariable[Constant=30]"</span><span class="p">));</span>
    <span class="n">onoff</span><span class="p">.</span><span class="n">SetAttribute</span><span class="p">(</span><span class="s">"OffTime"</span><span class="p">,</span> <span class="n">StringValue</span><span class="p">(</span><span class="s">"ns3::ConstantRandomVariable[Constant=0]"</span><span class="p">));</span>
    <span class="n">ApplicationContainer</span> <span class="n">onOffApp</span><span class="p">[</span><span class="n">NUMBER_OF_BOTS</span><span class="p">];</span>

    <span class="c1">//Install application in all bots</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">NUMBER_OF_BOTS</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">onOffApp</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">onoff</span><span class="p">.</span><span class="n">Install</span><span class="p">(</span><span class="n">botNodes</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="n">k</span><span class="p">));</span>
        <span class="n">onOffApp</span><span class="p">[</span><span class="n">k</span><span class="p">].</span><span class="n">Start</span><span class="p">(</span><span class="n">Seconds</span><span class="p">(</span><span class="mf">0.0</span><span class="p">));</span>
        <span class="n">onOffApp</span><span class="p">[</span><span class="n">k</span><span class="p">].</span><span class="n">Stop</span><span class="p">(</span><span class="n">Seconds</span><span class="p">(</span><span class="n">MAX_SIMULATION_TIME</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="c1">// Sender Application (Packets generated by this application are throttled)</span>
    <span class="n">BulkSendHelper</span> <span class="n">bulkSend</span><span class="p">(</span><span class="s">"ns3::TcpSocketFactory"</span><span class="p">,</span> <span class="n">InetSocketAddress</span><span class="p">(</span><span class="n">i12</span><span class="p">.</span><span class="n">GetAddress</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">TCP_SINK_PORT</span><span class="p">));</span>
    <span class="n">bulkSend</span><span class="p">.</span><span class="n">SetAttribute</span><span class="p">(</span><span class="s">"MaxBytes"</span><span class="p">,</span> <span class="n">UintegerValue</span><span class="p">(</span><span class="n">MAX_BULK_BYTES</span><span class="p">));</span>
    <span class="n">ApplicationContainer</span> <span class="n">bulkSendApp</span> <span class="o">=</span> <span class="n">bulkSend</span><span class="p">.</span><span class="n">Install</span><span class="p">(</span><span class="n">nodes</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
    <span class="n">bulkSendApp</span><span class="p">.</span><span class="n">Start</span><span class="p">(</span><span class="n">Seconds</span><span class="p">(</span><span class="mf">0.0</span><span class="p">));</span>
    <span class="n">bulkSendApp</span><span class="p">.</span><span class="n">Stop</span><span class="p">(</span><span class="n">Seconds</span><span class="p">(</span><span class="n">MAX_SIMULATION_TIME</span> <span class="o">-</span> <span class="mi">10</span><span class="p">));</span>

    <span class="c1">// UDPSink on receiver side</span>
    <span class="n">PacketSinkHelper</span> <span class="n">UDPsink</span><span class="p">(</span><span class="s">"ns3::UdpSocketFactory"</span><span class="p">,</span>
                             <span class="n">Address</span><span class="p">(</span><span class="n">InetSocketAddress</span><span class="p">(</span><span class="n">Ipv4Address</span><span class="o">::</span><span class="n">GetAny</span><span class="p">(),</span> <span class="n">UDP_SINK_PORT</span><span class="p">)));</span>
    <span class="n">ApplicationContainer</span> <span class="n">UDPSinkApp</span> <span class="o">=</span> <span class="n">UDPsink</span><span class="p">.</span><span class="n">Install</span><span class="p">(</span><span class="n">nodes</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>
    <span class="n">UDPSinkApp</span><span class="p">.</span><span class="n">Start</span><span class="p">(</span><span class="n">Seconds</span><span class="p">(</span><span class="mf">0.0</span><span class="p">));</span>
    <span class="n">UDPSinkApp</span><span class="p">.</span><span class="n">Stop</span><span class="p">(</span><span class="n">Seconds</span><span class="p">(</span><span class="n">MAX_SIMULATION_TIME</span><span class="p">));</span>

    <span class="c1">// TCP Sink Application on server side</span>
    <span class="n">PacketSinkHelper</span> <span class="n">TCPsink</span><span class="p">(</span><span class="s">"ns3::TcpSocketFactory"</span><span class="p">,</span>
                             <span class="n">InetSocketAddress</span><span class="p">(</span><span class="n">Ipv4Address</span><span class="o">::</span><span class="n">GetAny</span><span class="p">(),</span> <span class="n">TCP_SINK_PORT</span><span class="p">));</span>
    <span class="n">ApplicationContainer</span> <span class="n">TCPSinkApp</span> <span class="o">=</span> <span class="n">TCPsink</span><span class="p">.</span><span class="n">Install</span><span class="p">(</span><span class="n">nodes</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>
    <span class="n">TCPSinkApp</span><span class="p">.</span><span class="n">Start</span><span class="p">(</span><span class="n">Seconds</span><span class="p">(</span><span class="mf">0.0</span><span class="p">));</span>
    <span class="n">TCPSinkApp</span><span class="p">.</span><span class="n">Stop</span><span class="p">(</span><span class="n">Seconds</span><span class="p">(</span><span class="n">MAX_SIMULATION_TIME</span><span class="p">));</span>

    <span class="n">Ipv4GlobalRoutingHelper</span><span class="o">::</span><span class="n">PopulateRoutingTables</span><span class="p">();</span>

    <span class="c1">//Simulation NetAnim configuration and node placement</span>
    <span class="n">MobilityHelper</span> <span class="n">mobility</span><span class="p">;</span>

    <span class="n">mobility</span><span class="p">.</span><span class="n">SetPositionAllocator</span><span class="p">(</span><span class="s">"ns3::GridPositionAllocator"</span><span class="p">,</span>
                                  <span class="s">"MinX"</span><span class="p">,</span> <span class="n">DoubleValue</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s">"MinY"</span><span class="p">,</span> <span class="n">DoubleValue</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="s">"DeltaX"</span><span class="p">,</span> <span class="n">DoubleValue</span><span class="p">(</span><span class="mf">5.0</span><span class="p">),</span> <span class="s">"DeltaY"</span><span class="p">,</span> <span class="n">DoubleValue</span><span class="p">(</span><span class="mf">10.0</span><span class="p">),</span>
                                  <span class="s">"GridWidth"</span><span class="p">,</span> <span class="n">UintegerValue</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="s">"LayoutType"</span><span class="p">,</span> <span class="n">StringValue</span><span class="p">(</span><span class="s">"RowFirst"</span><span class="p">));</span>

    <span class="n">mobility</span><span class="p">.</span><span class="n">SetMobilityModel</span><span class="p">(</span><span class="s">"ns3::ConstantPositionMobilityModel"</span><span class="p">);</span>

    <span class="n">mobility</span><span class="p">.</span><span class="n">Install</span><span class="p">(</span><span class="n">nodes</span><span class="p">);</span>
    <span class="n">mobility</span><span class="p">.</span><span class="n">Install</span><span class="p">(</span><span class="n">botNodes</span><span class="p">);</span>

    <span class="n">AnimationInterface</span> <span class="n">anim</span><span class="p">(</span><span class="s">"DDoSim.xml"</span><span class="p">);</span>

    <span class="n">ns3</span><span class="o">::</span><span class="n">AnimationInterface</span><span class="o">::</span><span class="n">SetConstantPosition</span><span class="p">(</span><span class="n">nodes</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="n">ns3</span><span class="o">::</span><span class="n">AnimationInterface</span><span class="o">::</span><span class="n">SetConstantPosition</span><span class="p">(</span><span class="n">nodes</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
    <span class="n">ns3</span><span class="o">::</span><span class="n">AnimationInterface</span><span class="o">::</span><span class="n">SetConstantPosition</span><span class="p">(</span><span class="n">nodes</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>

    <span class="kt">uint32_t</span> <span class="n">x_pos</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">l</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">l</span> <span class="o">&lt;</span> <span class="n">NUMBER_OF_BOTS</span><span class="p">;</span> <span class="o">++</span><span class="n">l</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">ns3</span><span class="o">::</span><span class="n">AnimationInterface</span><span class="o">::</span><span class="n">SetConstantPosition</span><span class="p">(</span><span class="n">botNodes</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="n">x_pos</span><span class="o">++</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">//Run the Simulation</span>
    <span class="n">Simulator</span><span class="o">::</span><span class="n">Run</span><span class="p">();</span>
    <span class="n">Simulator</span><span class="o">::</span><span class="n">Destroy</span><span class="p">();</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

</code></pre></div></div>
<h3 id="simulation-result">Simulation Result</h3>

<p>Let’s build the project and check our simulations.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./waf <span class="nt">--run</span> DDoSim
</code></pre></div></div>
<p><img src="https://miro.medium.com/max/700/1*bfscwe_3yJ2EDK8Wsa6ssg.png" alt="" />(“Building Simulation with waf”)</p>

<p>After that we should have DDoSim.xml which we can load in NetAnim for Simulation.</p>

<h4 id="with-1-bot">With 1 Bot</h4>

<p><img src="/assets/images/1botsim.gif" alt="" /></p>

<p>Here we can see that there is not much interference in network speed. and Alice is able to complete the file transfer.</p>

<h4 id="with-10-bots">With 10 Bots</h4>

<p><img src="/assets/images/10botsim.gif" alt="" />
Here we can see significant effect on network speed and the after 2nd packet client is struggling in receiving requested resources.</p>

<h3 id="conclusion">Conclusion</h3>

<p>We can experiment with the above program and increase or decrease number of bots, bandwidth etc and observe the effect on the network.</p>

<p>I hope this will help you to visualize DDoS and get some technical insight.</p>

<p>The code is under GNU General Public License v3.0, so it can be used anywhere with proper citation.</p>

<p>That’s all for this article, will see you in next one.</p>

<p>Till then stay Caffeinated !</p>

<h5 id="resources">Resources</h5>

<table>
  <tbody>
    <tr>
      <td>NS-3 Docs : <a href="https://www.nsnam.org/">Official Website</a></td>
      <td><a href="https://www.nsnam.org/docs/tutorial/html/">NSNAM Tutorials</a></td>
      <td><a href="https://www.nsnam.org/documentation/">Official Documentation</a></td>
    </tr>
  </tbody>
</table>

<p>–</p>

    



<div class="post-tags">
  
    
    <a href="/topics.html#c">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">C++</span>
    </a>
  
    
    <a href="/topics.html#ns3">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">NS3</span>
    </a>
  
    
    <a href="/topics.html#simulation">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">Simulation</span>
    </a>
  
</div>
  </div>

  
  <section class="comments">
    <h2>Comments</h2>
    
  <div id="disqus_thread">
    <button class="disqus-load" onClick="loadDisqusComments()">
      Load Comments
    </button>
  </div>
  <script>

  /**
  *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW
  *  TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
  *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT:s
  *  https://disqus.com/admin/universalcode/#configuration-variables
  */
  var disqus_config = function () {
    this.page.url = "http://localhost:4000/2020/08/10/DDoS-Simulation-in-NS3-C++.html";
    this.page.identifier = "" ||
                           "http://localhost:4000/2020/08/10/DDoS-Simulation-in-NS3-C++.html";
  }
  function loadDisqusComments() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//saketupadhyay.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  }
  </script>
  <noscript>
    Please enable JavaScript to view the
    <a href="https://disqus.com/?ref_noscript">comments powered by Disqus</a>.
  </noscript>



  </section>

  <section class="related">
  <h2>Related Posts</h2>
  <ul class="posts-list">
    
      <li>
        <h3>
          <a href="/2020/08/23/hacking-unity-games-ctf.html">
            Intro to Unity Game Hacking (via CTF Writeup)
            <small>23 Aug 2020</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2020/08/18/sstf-vault-wtireup.html">
            Samsung CTF App Reverse Eng. Writeup (Detailed)
            <small>18 Aug 2020</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2020/08/17/ascwg-impossible-dream.html">
            ASCWG CTF Impossible Dream Writeup
            <small>17 Aug 2020</small>
          </a>
        </h3>
      </li>
    
  </ul>
</section>

</div>

    </main>

    <!-- Optional footer content -->

  </body>
</html>
